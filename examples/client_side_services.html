<html>

	<head>

		<script src="../monkeybars.js" type="text/javascript"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
		<script src="index.js"></script>

		<script type="text/javascript">
			
			function execute(e) { 
				
				var target = {};

				var gatherSocialData = new MonkeyBars.SequenceTask({
					//count:-1,
					//interval:3000,
					loggingEnabled:true,
					tasks:[
					{
						name:"get photos",
						performTask:function(){
							var delegate = this;
							$.getJSON('https://graph.facebook.com/target?fields=photos.limit(1)', function(data) {
								var photo = data.photos.data[0];
								target.photo = photo.picture;
								target.comment = photo.comments.data[0];
								delegate.complete();
							});
						}
					},
					{
						name:"get user",
						performTask:function(){
							var delegate = this;
							var user = target.comment.from.id;
							$.getJSON('https://graph.facebook.com/' + user, function(data) {
								target.user = data;
								delegate.complete();
							});
						}
					},
					{
						name:"structure html",
						performTask:function(){
							var s = "<div>";

							s += "<h1>Photo:</h1>";
							s += "<img src='" + target.photo + "'>";

							s += "<h3>Comment:</h3>";
							s += "<img src='http://graph.facebook.com/" + target.user.id + "/picture'>";
							s += "<p>" + target.user.name + "</p>";
							s += "<p>" + target.comment.message + "</p>";

							s += "</div";
							target.html = s;
							this.complete();
						}
					}
					],
					onStart:function(){
						$("#content").html("");
					},
					onComplete:function(){
						$("#content").html(target.html);
					}
				});

				gatherSocialData.start();

			}

		</script>

	</head>
	
	<body>
		<p>Client side example where you grab some json, format the json, make another call based on what you just formatted add that to the formatted json from before and return that.</p>
		<button onclick="execute();">Start Task</button>
		<div id="content"></div>
	</body>

</html>